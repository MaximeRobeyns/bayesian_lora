Search.setIndex({"docnames": ["bayesian_lora", "example_usage", "index", "kfac"], "filenames": ["bayesian_lora.rst", "example_usage.rst", "index.rst", "kfac.rst"], "titles": ["Bayesian Lora", "Example Usage", "Bayesian LoRA", "K-FAC Methods"], "terms": {"thi": [0, 1, 2, 3], "repositori": 2, "contain": [0, 2, 3], "an": [2, 3], "implement": [2, 3], "k": 2, "fac": 2, "languag": [0, 2], "model": [2, 3], "The": [0, 2, 3], "simplest": [2, 3], "wai": [2, 3], "us": [0, 2, 3], "librari": [2, 3], "i": [0, 2, 3], "simpli": 2, "pip": 2, "bayesian_lora": [0, 2, 3], "yet": 2, "publish": 2, "pypi": 2, "If": [2, 3], "you": 2, "would": [2, 3], "like": 2, "modifi": 2, "build": 2, "upon": 2, "while": [2, 3], "keep": 2, "separ": 2, "can": [2, 3], "clone": 2, "repo": 2, "run": 2, "git": 2, "http": 2, "github": 2, "com": 2, "maximerobeyn": 2, "cd": 2, "e": [0, 2, 3], "current": [2, 3], "veri": 2, "small": 2, "ha": [2, 3], "two": [2, 3], "core": 2, "depend": 2, "torch": [2, 3], "tqdm": [2, 3], "To": 2, "end": 2, "feel": 2, "free": 2, "directli": 2, "copi": 2, "file": [0, 1, 2], "need": 2, "your": [0, 2], "own": 2, "project": 2, "start": 2, "hack": [2, 3], "There": 2, "ar": [2, 3], "some": [2, 3], "includ": [2, 3], "befor": 2, "code": 2, "must": 2, "addit": 2, "which": [0, 2, 3], "omit": 2, "from": [0, 2, 3], "main": [0, 2, 3], "do": 2, "after": 2, "root": 2, "plan": 2, "mai": [2, 3], "wish": 2, "relat": [0, 2], "packag": 2, "dev": 2, "write": 2, "document": [2, 3], "requir": 2, "doc": 2, "For": 2, "simplic": 2, "also": 2, "just": [2, 3], "all": [2, 3], "test": 2, "function": [0, 2], "make": [0, 2, 3], "sure": 2, "have": [2, 3], "follow": [1, 2], "command": 2, "onc": 2, "set": [2, 3], "up": 2, "ipython": 2, "kernel": 2, "onli": [2, 3], "so": 2, "see": 2, "new": [2, 3], "insid": 2, "jupyterlab": 2, "launch": 2, "we": [2, 3], "conveni": 2, "target": [0, 2, 3], "lab": 2, "kroneck": [0, 3], "factor": [0, 3], "approxim": [0, 3], "curvatur": 3, "calculate_kronecker_factor": 3, "intern": 2, "method": [0, 2], "calcul": [0, 3], "fisher": 3, "inform": 3, "matrix": [0, 3], "ggn": 3, "further": 3, "themselv": 3, "low": [0, 3], "rank": [0, 2], "particularli": 3, "llm": 3, "where": 3, "4096": 3, "time": 3, "each": [0, 3], "layer": 3, "transform": 3, "modul": [0, 3], "forward_cal": 3, "callabl": 3, "ani": 3, "tensor": [0, 3], "loader": 3, "dataload": 3, "n_kfac": [0, 3], "int": [0, 3], "lr_threshold": 3, "devic": 0, "str": [0, 3], "dtype": 3, "none": 3, "target_module_keyword": 3, "list": 3, "lora": 3, "exclude_bia": 3, "bool": 3, "fals": 3, "use_tqdm": 3, "tupl": [0, 3], "dict": [0, 3], "kronec": 3, "A": [0, 3], "": [0, 3], "likelihood": [0, 3], "paramet": [0, 3], "adapt": [0, 3], "accept": 3, "batch": [0, 3], "provid": [0, 3], "data": [0, 3], "return": [0, 3], "logit": [0, 3], "predict": [0, 3], "distribut": 3, "dataset": [0, 3], "approximatino": [], "larg": [0, 3], "threshold": 3, "beyond": 3, "consid": [0, 3], "datatyp": [], "store": 3, "disk": [], "same": [], "keyword": 3, "identifi": 3, "network": [0, 3], "whose": 3, "want": 3, "hessian": 3, "whether": 3, "ignor": 3, "bia": 3, "term": 3, "show": 3, "progress": 3, "been": 3, "nn": 3, "linear": 3, "conv1d": 3, "g": [0, 3], "gpt2": 3, "sadli": 3, "work": 3, "now": 3, "dictionari": [0, 3], "activ": 3, "2": 3, "output": 3, "gradient": 3, "todo": [], "merg": [], "abov": 3, "It": 3, "call": 3, "number": [0, 3], "here": 3, "re": 3, "complet": 3, "register_hook": 3, "output_grad": 3, "10": 3, "100": 3, "regist": 3, "hook": 3, "attach": 3, "note": 3, "support": [0, 3], "treat": 3, "full": 2, "turn": 3, "off": 3, "lr": 3, "input": [0, 3], "wide": 3, "decid": 3, "narrow": 3, "b": 3, "weight": 3, "later": 3, "remov": 3, "map": 3, "indic": [0, 3], "remove_hook": 3, "save_input_hook": 3, "module_nam": 3, "has_bia": 3, "use_lr": [], "svd_dtype": 3, "float64": 3, "closur": 3, "captur": 3, "name": [0, 3], "kei": 3, "hash": 3, "more": [0, 3], "portabl": 3, "doe": 3, "appproxim": 3, "cast": 3, "svd": 3, "save_output_grad_hook": 3, "float32": [], "paper": 0, "tune": 0, "prior": 0, "hyperparamet": 0, "linearis": 0, "margin": 0, "scalar": 0, "valu": 0, "particular": [0, 3], "higher": 0, "under": 0, "given": 0, "model_evid": 0, "ll": 0, "n_lora": 0, "s2": 0, "instanc": 0, "varianc": 0, "log": 0, "interest": 0, "jacobian": 0, "n_logit": 0, "perform": 0, "token": 0, "hf": 0, "first": [0, 3], "deriv": 0, "class": [0, 3], "categor": 0, "kronekc": 0, "accumul": 0, "structur": 1, "python": 1, "directori": 1, "finish": 1, "evid": 2, "posterior": 2, "precis": 2, "usag": 2, "recal": 3, "find": 3, "block": 3, "diagon": 3, "had": 3, "simpl": 3, "4": 3, "mathbf": 3, "_": 3, "ell": 3, "product": 3, "twi": [], "one": 3, "correspond": 3, "1": [0, 3], "anoth": 3, "That": 3, "index": 3, "its": 3, "approx": 3, "otim": 3, "These": 3, "around": 3, "over": 3, "mathcal": 3, "d": 3, "what": 3, "below": 3, "rather": 3, "than": 3, "numer": 3, "ldot": 3, "l": 3, "differ": 3, "type": 3, "t": 3, "variant": 3, "factoris": 3, "mean": 3, "matric": 3, "exactli": 3, "kfac": 3, "calculate_full_kronecker_factor": [], "element": 3, "second": 3, "float": [0, 3], "l_in": [0, 3], "l_in_or_n_kfac": [0, 3], "l_out": [0, 3], "l_out_or_n_kfac": [0, 3], "three": 2, "jaxtyp": 2, "eeach": 3, "n_class": 3, "512": 3, "needn": 3, "usual": 3, "label": 3, "option": 3, "integ": 3, "side": 3, "length": 3, "appli": 3, "when": 3, "By": 3, "deafult": 3, "everi": 3, "should": 3, "exampl": 3, "fwd_call": 3, "adaptor": 3, "notic": 3, "how": 3, "removablehandl": 3, "equal": 3, "featur": 3, "last": 3, "dimens": 3, "regardless": 3, "presenc": 3, "unlik": 3, "exce": 3}, "objects": {"bayesian_lora": [[3, 0, 1, "", "calculate_kronecker_factors"]], "bayesian_lora.kfac": [[3, 0, 1, "", "register_hooks"], [3, 0, 1, "", "remove_hooks"], [3, 0, 1, "", "save_input_hook"], [3, 0, 1, "", "save_output_grad_hook"]], "bayesian_lora.main": [[0, 0, 1, "", "model_evidence"], [0, 0, 1, "", "precision"]]}, "objtypes": {"0": "py:function"}, "objnames": {"0": ["py", "function", "Python function"]}, "titleterms": {"bayesian": [0, 2], "lora": [0, 2], "instal": 2, "guid": 2, "edit": 2, "hackabl": 2, "exampl": [1, 2], "develop": 2, "jupyt": 2, "notebook": 2, "content": 2, "kroneck": [], "factor": [], "approxim": [], "curvatur": [], "intern": 3, "function": 3, "model": 0, "evid": 0, "posterior": 0, "precis": 0, "usag": 1, "todo": 1, "k": 3, "fac": 3, "method": 3, "full": 3, "rank": 3, "low": []}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.todo": 2, "sphinx": 60}, "alltitles": {"Example Usage": [[1, "example-usage"]], "Todo": [[1, "id2"]], "Bayesian Lora": [[0, "bayesian-lora"]], "Model Evidence": [[0, "model-evidence"]], "Posterior Precision": [[0, "posterior-precision"]], "Bayesian LoRA": [[2, "bayesian-lora"]], "Installation Guide": [[2, "installation-guide"]], "Editable Installation": [[2, "editable-installation"]], "Hackable Installation": [[2, "hackable-installation"]], "Installation with Examples": [[2, "installation-with-examples"]], "Development Installation": [[2, "development-installation"]], "Jupyter Notebooks": [[2, "jupyter-notebooks"]], "Contents": [[2, "contents"]], "Contents:": [[2, null]], "K-FAC Methods": [[3, "k-fac-methods"]], "Full-Rank K-FAC": [[3, "full-rank-k-fac"]], "Internal Functions": [[3, "internal-functions"]]}, "indexentries": {"model_evidence() (in module bayesian_lora.main)": [[0, "bayesian_lora.main.model_evidence"]], "precision() (in module bayesian_lora.main)": [[0, "bayesian_lora.main.precision"]], "calculate_kronecker_factors() (in module bayesian_lora)": [[3, "bayesian_lora.calculate_kronecker_factors"]], "register_hooks() (in module bayesian_lora.kfac)": [[3, "bayesian_lora.kfac.register_hooks"]], "remove_hooks() (in module bayesian_lora.kfac)": [[3, "bayesian_lora.kfac.remove_hooks"]], "save_input_hook() (in module bayesian_lora.kfac)": [[3, "bayesian_lora.kfac.save_input_hook"]], "save_output_grad_hook() (in module bayesian_lora.kfac)": [[3, "bayesian_lora.kfac.save_output_grad_hook"]]}})