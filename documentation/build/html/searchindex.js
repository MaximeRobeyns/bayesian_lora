Search.setIndex({"docnames": ["bayesian_lora", "index", "kfac"], "filenames": ["bayesian_lora.rst", "index.rst", "kfac.rst"], "titles": ["Bayesian Lora", "Bayesian LoRA", "Kronecker-Factored Approximate Curvature"], "terms": {"thi": [1, 2], "repositori": 1, "contain": 1, "an": [1, 2], "implement": [1, 2], "k": [1, 2], "fac": [1, 2], "languag": 1, "model": [1, 2], "The": [1, 2], "simplest": 1, "wai": [1, 2], "us": [1, 2], "librari": [1, 2], "i": [1, 2], "simpli": 1, "pip": 1, "bayesian_lora": [1, 2], "yet": 1, "publish": 1, "pypi": 1, "If": [1, 2], "you": 1, "would": 1, "like": 1, "modifi": 1, "build": 1, "upon": 1, "while": [1, 2], "keep": 1, "separ": 1, "can": [1, 2], "clone": 1, "repo": 1, "run": 1, "git": 1, "http": 1, "github": 1, "com": 1, "maximerobeyn": 1, "cd": 1, "e": [1, 2], "current": [1, 2], "veri": 1, "small": 1, "ha": [1, 2], "two": 1, "core": 1, "depend": 1, "torch": [1, 2], "tqdm": [1, 2], "To": 1, "end": 1, "feel": 1, "free": 1, "directli": 1, "copi": 1, "file": 1, "need": 1, "your": 1, "own": 1, "project": 1, "start": 1, "hack": 1, "There": 1, "ar": [1, 2], "some": 1, "includ": [1, 2], "befor": 1, "code": 1, "must": 1, "addit": 1, "which": [1, 2], "omit": [1, 2], "from": [1, 2], "main": [1, 2], "do": 1, "after": 1, "root": 1, "plan": 1, "mai": [1, 2], "wish": 1, "relat": 1, "packag": [1, 2], "dev": 1, "write": 1, "document": [1, 2], "requir": 1, "doc": 1, "For": 1, "simplic": 1, "also": 1, "just": [1, 2], "all": [1, 2], "test": 1, "function": 1, "make": [1, 2], "sure": 1, "have": [1, 2], "follow": 1, "command": 1, "onc": 1, "set": [1, 2], "up": 1, "ipython": 1, "kernel": 1, "onli": [1, 2], "so": 1, "see": 1, "new": [1, 2], "insid": 1, "jupyterlab": 1, "launch": 1, "we": [1, 2], "conveni": 1, "target": 1, "lab": 1, "kroneck": 1, "factor": 1, "approxim": 1, "curvatur": 1, "calculate_kronecker_factor": [1, 2], "intern": 1, "method": 2, "calcul": 2, "fisher": 2, "inform": 2, "matrix": 2, "ggn": 2, "further": 2, "themselv": 2, "low": 2, "rank": 2, "particularli": 2, "llm": 2, "where": 2, "4096": 2, "time": 2, "each": 2, "layer": 2, "transform": 2, "modul": 2, "forward_cal": 2, "callabl": 2, "ani": 2, "tensor": 2, "loader": 2, "dataload": 2, "n_kfac": 2, "int": 2, "lr_threshold": 2, "devic": 2, "str": 2, "dtype": 2, "none": 2, "target_module_keyword": 2, "list": 2, "lora": 2, "exclude_bia": 2, "bool": 2, "fals": 2, "use_tqdm": 2, "tupl": 2, "dict": 2, "kronec": 2, "A": 2, "": 2, "likelihood": 2, "paramet": 2, "adapt": 2, "accept": 2, "batch": 2, "provid": 2, "data": 2, "return": 2, "logit": 2, "predict": 2, "distribut": 2, "dataset": 2, "approximatino": 2, "larg": 2, "threshold": 2, "beyond": 2, "consid": 2, "datatyp": 2, "store": 2, "disk": 2, "same": 2, "keyword": 2, "identifi": 2, "network": 2, "whose": 2, "want": 2, "hessian": 2, "whether": 2, "ignor": 2, "bia": 2, "term": 2, "show": 2, "progress": 2, "been": 2, "nn": 2, "linear": 2, "conv1d": 2, "g": 2, "gpt2": 2, "sadli": 2, "work": 2, "now": 2, "dictionari": 2, "activ": 2, "2": 2, "output": 2, "gradient": 2, "todo": 2, "merg": 2, "abov": 2, "It": 2, "call": 2, "number": 2, "here": 2, "re": 2, "complet": 2, "register_hook": 2, "output_grad": 2, "10": 2, "100": 2, "regist": 2, "hook": 2, "attach": 2, "note": 2, "support": 2, "treat": 2, "full": 2, "turn": 2, "off": 2, "lr": 2, "input": 2, "wide": 2, "decid": 2, "narrow": 2, "b": 2, "weight": 2, "later": 2, "remov": 2, "map": 2, "indic": 2, "remove_hook": 2, "save_input_hook": 2, "module_nam": 2, "has_bia": 2, "use_lr": 2, "svd_dtype": 2, "float64": 2, "closur": 2, "captur": 2, "name": 2, "kei": 2, "hash": 2, "more": 2, "portabl": 2, "doe": 2, "appproxim": 2, "cast": 2, "svd": 2, "save_output_grad_hook": 2, "float32": 2}, "objects": {"bayesian_lora.main": [[2, 0, 1, "", "calculate_kronecker_factors"], [2, 0, 1, "", "register_hooks"], [2, 0, 1, "", "remove_hooks"], [2, 0, 1, "", "save_input_hook"], [2, 0, 1, "", "save_output_grad_hook"]]}, "objtypes": {"0": "py:function"}, "objnames": {"0": ["py", "function", "Python function"]}, "titleterms": {"bayesian": [0, 1], "lora": [0, 1], "instal": 1, "guid": 1, "edit": 1, "hackabl": 1, "exampl": 1, "develop": 1, "jupyt": 1, "notebook": 1, "content": 1, "kroneck": 2, "factor": 2, "approxim": 2, "curvatur": 2, "intern": 2, "function": 2}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.todo": 2, "sphinx": 60}, "alltitles": {"Bayesian Lora": [[0, "bayesian-lora"]], "Bayesian LoRA": [[1, "bayesian-lora"]], "Installation Guide": [[1, "installation-guide"]], "Editable Installation": [[1, "editable-installation"]], "Hackable Installation": [[1, "hackable-installation"]], "Installation with Examples": [[1, "installation-with-examples"]], "Development Installation": [[1, "development-installation"]], "Jupyter Notebooks": [[1, "jupyter-notebooks"]], "Contents": [[1, "contents"]], "Contents:": [[1, null]], "Kronecker-Factored Approximate Curvature": [[2, "kronecker-factored-approximate-curvature"]], "Internal Functions": [[2, "internal-functions"]]}, "indexentries": {"calculate_kronecker_factors() (in module bayesian_lora.main)": [[2, "bayesian_lora.main.calculate_kronecker_factors"]], "register_hooks() (in module bayesian_lora.main)": [[2, "bayesian_lora.main.register_hooks"]], "remove_hooks() (in module bayesian_lora.main)": [[2, "bayesian_lora.main.remove_hooks"]], "save_input_hook() (in module bayesian_lora.main)": [[2, "bayesian_lora.main.save_input_hook"]], "save_output_grad_hook() (in module bayesian_lora.main)": [[2, "bayesian_lora.main.save_output_grad_hook"]]}})